{% load static %}

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    {% block titulo %}
    <title>Modelo</title>
    {% endblock %}

    <!-- CSS principal -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}" />
    <link rel="stylesheet" href="{% static 'css/responsividade.css' %}" />

    <!-- Bloco para CSS específico de cada página -->
    {% block css_especifico %}
    <!-- CSS padrão que carrega em todas as páginas -->
    <link rel="stylesheet" href="{% static 'css/admin_section.css' %}" />
    <link rel="stylesheet" href="{% static 'css/form_modelo.css' %}" />
    <link rel="stylesheet" href="{% static 'css/form_login.css' %}" />
    <link rel="stylesheet" href="{% static 'css/lista_modelo.css' %}" />
    {% endblock %}

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>

  <body>
    {% if request.user.is_authenticated %}

    <!-- Sidebar/Menu Lateral -->
    {% block menu %}

    <!-- Overlay para menu mobile -->
    <div class="overlay"></div>

    <aside class="sidebar">
      <div class="sidebar-header">
        <h2><i class="fas fa-tractor"></i> Fazenda, Domiciano</h2>
        <p>Sistema de Gestão Agrícola</p>
      </div>

      <nav class="sidebar-menu">
        <ul>
          <li class="menu-item">
            <a href="{% url 'pagina_index' %}">
              <i class="fas fa-home"></i>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="menu-item">
            <a href="{% url 'listar_movimentacao_receita' %}">
              <i class="fas fa-hand-holding-usd"></i>
              <span>Receitas</span>
            </a>
          </li>
          <li class="menu-item">
            <a href="{% url 'listar_movimentacao_despesa' %}">
              <i class="fas fa-file-invoice-dollar"></i>
              <span>Despesas</span>
            </a>
          </li>
          <li class="menu-item">
            <a href="{% url 'listar_parcelas' %}">
              <i class="fas fa-money-bill-wave"></i>
              <span>Lançamentos Futuros</span>
            </a>
          </li>
          <li class="menu-item">
            <a href="{% url 'medicamento_estoque' %}">
              <i class="fas fa-pills"></i>
              <span>Medicamentos</span>
            </a>
          </li>
          <li class="menu-item">
            <a href="relatorios.html">
              <i class="fas fa-chart-bar"></i>
              <span>Relatórios</span>
            </a>
          </li>
        </ul>
      </nav>

      <div class="sidebar-footer">
        <div class="user-info">
          <div>
            <strong>{{ request.user }}</strong>
          </div>
        </div>
        <form method="post" action="{% url 'logout' %}" style="display: inline">
          {% csrf_token %}
          <button
            type="submit"
            class="logout-btn"
            style="background: none; border: none; padding: 0; cursor: pointer"
          >
            <i class="fas fa-sign-out-alt"></i>
          </button>
        </form>
      </div>
    </aside>
    {% endblock %}

    <!-- Conteúdo Principal -->
    {% block conteudo %}
    <main class="main-content">
      <header class="content-header">
        <h1>Dashboard</h1>
        <div class="header-actions">
          <div class="search-box">
            <input type="text" placeholder="Pesquisar..." />
            <i class="fas fa-search"></i>
          </div>
          {% block admin %}
          <!-- Botão de acesso à área admin (apenas para superusers) -->
          {% if request.user.is_superuser %}
          <button class="admin-toggle">
            <i class="fas fa-cogs"></i> Área Admin
          </button>
          {% endif %} {% endblock %}
          <button class="btn btn-notification">
            <i class="fas fa-bell"></i>
            <span class="badge">3</span>
          </button>
        </div>
        <button class="mobile-menu-btn">
          <i class="fas fa-bars"></i>
        </button>
      </header>
      {% endblock %} {% block conteudo_admin %}
      <!-- Seção de Administração (apenas para superusers) -->
      {% if request.user.is_superuser %}
      <section class="admin-section">
        <h2><i class="fas fa-user-shield"></i> Área de Administração</h2>
        <div class="admin-cards">
          <div class="admin-card">
            <i class="fas fa-user-shield"></i>
            <h3>Painel Admin</h3>
            <p>Painel completo do Django</p>
            <a href="/admin/" target="_blank">Acessar</a>
          </div>

          <div class="admin-card">
            <i class="fas fa-pills"></i>
            <h3>Medicamentos</h3>
            <p>Gerenciar medicamentos</p>
            <a href="{% url 'cadastro_medicamento' %}">Gerenciar</a>
          </div>

          <div class="admin-card">
            <i class="fas fa-tags"></i>
            <h3>Categorias</h3>
            <p>Gerenciar categorias</p>
            <a href="#">Gerenciar</a>
          </div>

          <div class="admin-card">
            <i class="fas fa-users"></i>
            <h3>Usuários</h3>
            <p>Gerenciar usuários</p>
            <a href="#">Gerenciar</a>
          </div>

          <div class="admin-card">
            <i class="fas fa-tractor"></i>
            <h3>Fazendas</h3>
            <p>Gerenciar fazendas</p>
            <a href="#">Gerenciar</a>
          </div>
        </div>
      </section>
      {% endif %} {%endblock%}

      <!-- Cards Resumo -->
      {% block cards %}
      <section class="summary-cards">
        <div class="card card-receita">
          <div class="card-icon">
            <i class="fas fa-hand-holding-usd"></i>
          </div>
          <div class="card-info">
            <h3>Receitas</h3>
            <p>R$ 85.420,00</p>
            <small>+12% este mês</small>
          </div>
          <a href="" class="card-link">Ver tudo</a>
        </div>

        <div class="card card-medicamento">
          <div class="card-icon">
            <i class="fas fa-pills"></i>
          </div>
          <div class="card-info">
            <h3>Medicamentos</h3>
            <p>32 itens</p>
            <small>5 próximos de vencer</small>
          </div>
          <a href="medicamentos.html" class="card-link">Ver tudo</a>
        </div>

        <div class="card card-alerta">
          <div class="card-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <div class="card-info">
            <h3>Alertas</h3>
            <p>5 pendências</p>
            <small>3 urgentes</small>
          </div>
          <a href="alertas.html" class="card-link">Ver tudo</a>
        </div>
      </section>
      {% endblock %}

      <!-- Seção de Gráficos -->
      {% block graficos %}
      <section class="charts-section">
        <div class="chart-container">
          <h3>Receitas vs Despesas (Últimos 6 meses)</h3>
          <canvas id="lineChart"></canvas>
        </div>

        <div class="chart-container">
          <h3>Distribuição de Despesas</h3>
          <canvas id="pieChart"></canvas>
        </div>
      </section>
      {% endblock %}

      <!-- Últimos Registros -->
      {% block ultimos_registros %}
      <section class="recent-activity">
        <div class="activity-section">
          <h3>Últimas Receitas</h3>
          <div class="activity-list">
            <div class="activity-item">
              <i class="fas fa-hand-holding-usd"></i>
              <div>
                <strong>Venda de Soja</strong>
                <p>Fazenda Boa Esperança - R$ 15.000,00</p>
                <small>15/06/2023</small>
              </div>
              <a href="receita-detalhes.html" class="btn btn-sm">Detalhes</a>
            </div>
            <div class="activity-item">
              <i class="fas fa-hand-holding-usd"></i>
              <div>
                <strong>Subsídio Governamental</strong>
                <p>Programa de Incentivo - R$ 8.750,00</p>
                <small>10/06/2023</small>
              </div>
              <a href="receita-detalhes.html" class="btn btn-sm">Detalhes</a>
            </div>
          </div>
          <a href="receitas.html" class="see-all">Ver todas as receitas →</a>
        </div>

        <div class="activity-section">
          <h3>Últimas Despesas</h3>
          <div class="activity-list">
            <div class="activity-item">
              <i class="fas fa-file-invoice-dollar"></i>
              <div>
                <strong>Compra de Insumos</strong>
                <p>Agropecuária Santa Maria - R$ 3.200,00</p>
                <small>14/06/2023</small>
              </div>
              <a href="despesa-detalhes.html" class="btn btn-sm">Detalhes</a>
            </div>
            <div class="activity-item">
              <i class="fas fa-file-invoice-dollar"></i>
              <div>
                <strong>Manutenção de Equipamentos</strong>
                <p>Trator JD 7250 - R$ 1.850,00</p>
                <small>12/06/2023</small>
              </div>
              <a href="despesa-detalhes.html" class="btn btn-sm">Detalhes</a>
            </div>
          </div>
          <a href="despesas.html" class="see-all">Ver todas as despesas →</a>
        </div>

        <div class="activity-section">
          <h3>Medicamentos Próximos de Vencer</h3>
          <div class="activity-list">
            <div class="activity-item">
              <i class="fas fa-pills"></i>
              <div>
                <strong>Ivermectina</strong>
                <p>Lote: #IVM2023 - Quantidade: 15</p>
                <small>Vence em: 30/06/2023</small>
              </div>
              <a href="medicamento-detalhes.html" class="btn btn-sm"
                >Detalhes</a
              >
            </div>
            <div class="activity-item">
              <i class="fas fa-pills"></i>
              <div>
                <strong>Oxitetraciclina</strong>
                <p>Lote: #OXT2023 - Quantidade: 8</p>
                <small>Vence em: 15/07/2023</small>
              </div>
              <a href="medicamento-detalhes.html" class="btn btn-sm"
                >Detalhes</a
              >
            </div>
          </div>
          <a href="medicamentos.html" class="see-all"
            >Ver todos os medicamentos →</a
          >
        </div>
      </section>
    </main>
    {% endblock %} {% else %}
    <main class="main-content login-page">
      <div class="login-container">
        <div class="login-header">
          <h2>Você precisa estar autenticado para acessar o sistema.</h2>
          <a href="{% url 'login' %}" class="btn-primary">Fazer Login</a>
        </div>
      </div>
    </main>
    {% endif %}
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- Script principal primeiro -->
    <script src="{% static 'js/mobile.js' %}"></script>
    
    <!-- Depois os outros scripts -->
    <script src="{% static 'js/admin_menu.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
    window.graficoData = {{ grafico_data_json|safe }};
    </script>
    <script src="{% static 'js/grafico.js' %}"></script>
  </body>
</html>